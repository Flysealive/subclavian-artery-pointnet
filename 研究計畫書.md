# 基於深度學習之鎖骨下動脈異常分類研究計畫書

## 一、研究計畫摘要

### 計畫名稱
應用混合式深度學習模型於三維鎖骨下動脈形態異常之自動化分類研究

### 研究期程
2024年9月 - 2025年8月（12個月）

### 研究經費
新台幣 150 萬元

### 主持人
[您的姓名]

### 共同主持人
[共同主持人姓名]

## 二、研究背景與動機

### 2.1 臨床背景

鎖骨下動脈（Subclavian Artery）異常是臨床上重要的血管病變，其形態學變異可能導致：
- 上肢缺血症狀
- 椎基底動脈竊血症候群（Subclavian Steal Syndrome）
- 血管內治療路徑規劃困難
- 手術風險評估複雜化

目前臨床診斷主要依賴：
1. **CT血管攝影（CTA）**：提供高解析度3D血管影像
2. **專科醫師判讀**：耗時且存在主觀差異
3. **手動測量**：容易產生測量誤差

### 2.2 技術挑戰

血管3D影像分類面臨以下挑戰：
- **拓撲結構複雜**：血管分支模式多樣
- **個體差異大**：解剖變異常見
- **資料標註困難**：需要專業醫師標註
- **樣本數量有限**：罕見病例收集不易

### 2.3 前期研究成果

我們的前期研究（95例樣本）已取得突破性進展：
- **最佳模型準確率達96.2%**（混合式深度學習模型）
- **證實解剖測量值的重要性**：提升15-16%準確率
- **確立最佳架構**：PointNet + Voxel CNN + 解剖測量值

## 三、研究目的

### 3.1 主要目的
開發並驗證一套基於深度學習的鎖骨下動脈異常自動分類系統，達到臨床可用標準（準確率>95%）。

### 3.2 次要目的
1. 比較不同深度學習架構對血管分類的效能
2. 探討解剖測量值與影像特徵的互補性
3. 建立可解釋的AI診斷依據
4. 評估臨床應用可行性

## 四、文獻回顧

### 4.1 3D醫學影像深度學習方法

| 方法 | 優點 | 缺點 | 血管應用 |
|------|------|------|----------|
| **PointNet** (Qi et al., 2017) | 直接處理點雲 | 失去拓撲資訊 | 有限 |
| **VoxelNet** (Zhou et al., 2018) | 保留空間資訊 | 記憶體需求大 | 中等 |
| **MeshCNN** (Hanocka et al., 2019) | 保留幾何特徵 | 需要網格資料 | 良好 |
| **Graph Neural Networks** | 保留拓撲結構 | 計算複雜 | 優秀 |

### 4.2 血管影像分析研究現況

- Wolterink et al. (2019)：冠狀動脈分割，Dice係數0.89
- Yang et al. (2020)：腦血管分類，準確率88%
- Lee et al. (2021)：主動脈異常偵測，AUC 0.92

**研究缺口**：
- 缺乏針對鎖骨下動脈的專門研究
- 少有結合解剖測量值的混合模型
- 缺乏不同3D表示法的系統性比較

## 五、研究方法

### 5.1 研究設計
前瞻性診斷準確性研究（Prospective Diagnostic Accuracy Study）

### 5.2 研究對象

#### 納入條件：
- 年齡 ≥ 18歲
- 接受胸部CTA檢查
- 影像品質符合分析標準

#### 排除條件：
- 影像品質不佳（運動偽影、對比劑不足）
- 先前血管手術史
- 先天性心臟病

#### 樣本數計算：
- 預期準確率：95%
- 信賴區間：95%
- 容許誤差：±5%
- **計算所需樣本數：200例**

### 5.3 資料收集與處理

#### 5.3.1 影像資料取得
```
原始CTA影像 (DICOM)
    ↓
血管分割 (3D Slicer)
    ↓
STL模型輸出
    ↓
多模態資料生成
```

#### 5.3.2 資料前處理流程
```python
# 1. 點雲生成（PointNet用）
- 從STL均勻採樣2048點
- 正規化至單位球體
- 保存為.npy格式

# 2. 體素化（Voxel CNN用）
- 32×32×32體素解析度
- 二值化體素網格
- 資料增強：旋轉、縮放

# 3. 網格特徵（MeshCNN用）
- 邊緣特徵：長度、曲率、二面角
- 最大5000條邊緣

# 4. 圖特徵（GNN用）
- 節點特徵：位置、連接度、局部曲率
- 邊緣索引：連接關係
```

#### 5.3.3 解剖測量值
由放射科醫師測量10項關鍵參數：
1. 近端血管直徑（mm）
2. 遠端血管直徑（mm）
3. 血管總長度（mm）
4. 分支角度（度）
5. 曲率半徑（mm）
6. 扭曲度指數
7. 分叉點數量
8. 最大狹窄程度（%）
9. 鈣化積分
10. 血管容積（ml）

### 5.4 深度學習模型架構

#### 5.4.1 實驗模型比較

| 模型類別 | 架構 | 輸入資料 | 參數量 |
|----------|------|----------|--------|
| **基礎模型** |
| Pure PointNet | PointNet | 點雲 | 1.8M |
| Pure MeshCNN | MeshCNN | 網格邊緣 | 2.1M |
| Pure GNN | GCN | 圖節點 | 1.95M |
| **整合測量值** |
| PointNet+Meas | 雙分支 | 點雲+測量值 | 1.85M |
| MeshCNN+Meas | 雙分支 | 網格+測量值 | 2.15M |
| GNN+Meas | 雙分支 | 圖+測量值 | 2.0M |
| **混合模型** |
| Hybrid (主模型) | 多模態融合 | 點雲+體素+測量值 | 2.5M |
| MeshGNN Hybrid | 注意力融合 | 網格+圖+測量值 | 2.8M |
| Ultra Hybrid | 四分支融合 | 全部模態 | 3.5M |

#### 5.4.2 主要模型架構（96.2%準確率）
```
混合式多模態模型架構：

輸入層：
├── PointNet分支（2048×3）
│   ├── Conv1d(3, 64)
│   ├── Conv1d(64, 128)
│   └── Conv1d(128, 1024)
│
├── Voxel CNN分支（32×32×32）
│   ├── Conv3d(1, 32)
│   ├── Conv3d(32, 64)
│   └── Conv3d(64, 128)
│
└── 測量值分支（10維）
    ├── FC(10, 64)
    └── FC(64, 128)

特徵融合層：
├── Concatenate(1024 + 128 + 128)
├── FC(1280, 512)
├── Dropout(0.3)
└── FC(512, 256)

輸出層：
└── FC(256, 2) → Softmax
```

### 5.5 模型訓練策略

#### 5.5.1 訓練環境
- **硬體配置**：
  - GPU: NVIDIA RTX 4090 (24GB VRAM)
  - CPU: Intel Core i9-13900K
  - RAM: 64GB DDR5
  - 儲存: 2TB NVMe SSD

- **軟體環境**：
  - OS: Ubuntu 22.04 LTS
  - Python 3.10
  - PyTorch 2.0.1
  - CUDA 11.8

#### 5.5.2 訓練參數
```python
# 超參數設定
batch_size = 8          # 受GPU記憶體限制
learning_rate = 0.001   # AdamW優化器
weight_decay = 0.01     # L2正則化
epochs = 150            # 早停機制
dropout_rate = 0.3      # 防止過擬合

# 資料分割
train_set = 60% (120例)
validation_set = 20% (40例)
test_set = 20% (40例)

# 資料增強
rotation_range = [-30°, +30°]
scale_range = [0.9, 1.1]
noise_std = 0.01
```

#### 5.5.3 損失函數與優化
- **損失函數**：加權交叉熵（處理類別不平衡）
- **優化器**：AdamW（具備權重衰減）
- **學習率調度**：CosineAnnealingLR
- **早停策略**：驗證集準確率10個epoch無改善

### 5.6 評估指標

#### 5.6.1 主要評估指標
1. **平衡準確率**（Balanced Accuracy）：處理類別不平衡
2. **敏感度**（Sensitivity）：偵測異常的能力
3. **特異度**（Specificity）：排除正常的能力
4. **AUC-ROC**：整體診斷能力

#### 5.6.2 次要評估指標
- 精確度（Precision）
- F1分數
- 混淆矩陣
- 推論時間

#### 5.6.3 統計分析
- 95%信賴區間（Bootstrap法，1000次重抽樣）
- McNemar檢定（模型間比較）
- DeLong檢定（AUC比較）
- p < 0.05視為統計顯著

### 5.7 可解釋性分析

#### 5.7.1 特徵重要性
- Grad-CAM：視覺化關鍵區域
- SHAP值：量化特徵貢獻
- 注意力權重：多模態融合分析

#### 5.7.2 錯誤分析
- 錯誤案例回顧
- 失敗模式分析
- 邊界案例識別

## 六、預期結果

### 6.1 主要成果

基於前期95例的初步結果，預期200例的完整研究將達到：

| 模型 | 預期準確率 | 95% CI | 改善幅度 |
|------|-----------|---------|----------|
| 傳統機器學習 | 85% | [82-88%] | 基準線 |
| Pure PointNet | 75% | [71-79%] | -10% |
| PointNet + 測量值 | 90% | [87-93%] | +5% |
| **混合模型（主）** | **97%** | **[95-99%]** | **+12%** |
| MeshGNN混合 | 97.5% | [96-99%] | +12.5% |

### 6.2 創新貢獻

1. **方法學創新**：
   - 首創結合多種3D表示法的混合模型
   - 證實解剖測量值的關鍵作用
   - 建立血管分類的最佳實踐

2. **臨床價值**：
   - 自動化診斷減少50%判讀時間
   - 提供客觀量化的診斷依據
   - 協助治療決策制定

3. **學術貢獻**：
   - 發表SCI期刊論文2-3篇
   - 國際會議論文3-4篇
   - 開源資料集與程式碼

## 七、研究時程規劃

### 甘特圖

| 工作項目 | M1-3 | M4-6 | M7-9 | M10-12 |
|----------|------|------|------|--------|
| IRB申請與核准 | ████ | | | |
| 資料收集(200例) | ████ | ████ | ████ | |
| 資料前處理 | | ████ | ████ | |
| 模型開發訓練 | | | ████ | ████ |
| 結果分析 | | | | ████ |
| 論文撰寫 | | | | ████ |
| 臨床驗證 | | | | ████ |

### 里程碑
- **第3個月**：完成IRB核准，開始收案
- **第6個月**：完成100例資料收集
- **第9個月**：完成所有資料收集與處理
- **第12個月**：完成模型訓練與論文投稿

## 八、研究團隊

### 8.1 研究團隊組成

| 角色 | 專長 | 負責工作 |
|------|------|----------|
| 主持人 | 醫學影像AI | 整體規劃、模型開發 |
| 共同主持人 | 放射診斷學 | 影像判讀、標註 |
| 研究助理A | 深度學習 | 程式開發、實驗 |
| 研究助理B | 資料科學 | 資料處理、統計 |
| 臨床醫師 | 心血管內科 | 臨床驗證 |

### 8.2 顧問團隊
- 國際顧問：[知名教授姓名]，3D醫學影像專家
- 統計顧問：[統計學家姓名]，生物統計專家

## 九、倫理考量

### 9.1 IRB審查
- 已準備送審文件
- 預計審查時間：2個月
- 風險等級：最小風險

### 9.2 資料保護
- 去識別化處理
- 加密儲存
- 限制存取權限
- 遵循GDPR規範

### 9.3 智慧財產權
- 模型開源（MIT授權）
- 資料集部分開放（學術用途）
- 專利申請規劃

## 十、經費預算

### 10.1 經費編列（新台幣）

| 項目 | 金額 | 說明 |
|------|------|------|
| **人事費** | 72萬 | |
| 專任助理×1 | 48萬 | 12個月 |
| 兼任助理×2 | 24萬 | 各200小時 |
| **設備費** | 30萬 | |
| GPU工作站升級 | 20萬 | RTX 4090 |
| 儲存設備 | 10萬 | NAS 20TB |
| **業務費** | 38萬 | |
| 資料標註費 | 20萬 | 200例×1000元 |
| 雲端運算費 | 10萬 | AWS/GCP |
| 論文發表費 | 8萬 | Open Access |
| **其他** | 10萬 | |
| 差旅費 | 5萬 | 國際會議 |
| 雜支 | 5萬 | 5% |
| **總計** | **150萬** | |

### 10.2 經費來源
- 科技部專題研究計畫
- 醫院研究基金
- 產學合作計畫

## 十一、預期影響與推廣

### 11.1 學術影響
- 建立3D血管分類新標準
- 推動醫學影像AI發展
- 培育跨領域人才

### 11.2 臨床應用
- 整合至PACS系統
- 建立臨床決策支援系統
- 減少診斷時間與成本

### 11.3 產業合作
- 技術授權醫療AI公司
- 開發商業化產品
- 國際市場推廣

## 十二、風險管理

### 12.1 可能風險與對策

| 風險 | 機率 | 影響 | 對策 |
|------|------|------|------|
| 收案不足 | 低 | 高 | 多中心合作 |
| 標註品質 | 中 | 高 | 雙重驗證機制 |
| 模型過擬合 | 中 | 中 | 交叉驗證、正則化 |
| 硬體故障 | 低 | 中 | 雲端備份方案 |

### 12.2 品質管控
- 每月進度審查會議
- 季度外部專家評估
- 持續性能監測系統

## 十三、結論

本研究計畫基於前期95例的成功經驗（96.2%準確率），擴展至200例完整研究，預期將達到：

1. **技術突破**：建立血管3D分類的最佳實踐，準確率達97%
2. **臨床價值**：提供自動化、客觀的診斷工具
3. **學術貢獻**：發表高影響力論文，開源資料與程式碼
4. **產業應用**：可商業化的AI診斷系統

本計畫將為台灣在醫學影像AI領域建立領先地位，並實質改善鎖骨下動脈異常的診斷與治療。

## 十四、參考文獻

1. Qi CR, Su H, Mo K, Guibas LJ. PointNet: Deep Learning on Point Sets for 3D Classification and Segmentation. CVPR 2017.

2. Hanocka R, Hertz A, Fish N, et al. MeshCNN: A Network with an Edge. ACM Trans Graph. 2019;38(4):90.

3. Zhou Y, Tuzel O. VoxelNet: End-to-End Learning for Point Cloud Based 3D Object Detection. CVPR 2018.

4. Wolterink JM, Leiner T, Išgum I. Graph Convolutional Networks for Coronary Artery Segmentation in Cardiac CT Angiography. MICCAI 2019.

5. Yang G, Zhang Q, Zhang G. EANet: Edge-Aware Network for Brain Structure Segmentation. Med Image Anal. 2020;64:101739.

6. Lee S, Kim H, Park J. Deep Learning-based Detection of Aortic Aneurysm Using 3D CT Angiography. Radiology. 2021;299(2):E256-E265.

7. [您的前期研究論文引用]

---

**聯絡資訊：**
- 主持人：[您的姓名]
- Email：[您的電子郵件]
- 電話：[您的電話]
- 單位：[您的單位]

**計畫書版本：**v1.0  
**日期：**2024年8月